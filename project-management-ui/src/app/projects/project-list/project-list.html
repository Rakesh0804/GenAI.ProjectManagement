<div class="project-list-container">
  <div class="header">
    <div class="search-section">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search projects...</mat-label>
        <input matInput 
               [(ngModel)]="searchTerm" 
               (input)="onSearchChange($event)"
               placeholder="Search by name, client, or description">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>
    <button mat-raised-button color="primary" (click)="createProject()">
      <mat-icon>add</mat-icon>
      New Project
    </button>
  </div>

  <div class="project-grid" *ngIf="!loading">
    <mat-card class="project-card" *ngFor="let project of filteredProjects">
      <mat-card-header>
        <mat-card-title>{{ project.name }}</mat-card-title>
        <mat-card-subtitle>{{ project.clientName }}</mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <p class="description">{{ project.description }}</p>
        
        <div class="project-meta">
          <div class="status-priority">
            <mat-chip [class]="getStatusClass(project.status)">
              {{ getStatusLabel(project.status) }}
            </mat-chip>
            <mat-chip [class]="getPriorityClass(project.priority)">
              {{ getPriorityLabel(project.priority) }}
            </mat-chip>
          </div>

          <div class="budget">
            <!-- <mat-icon>attach_money</mat-icon> -->
            <span>{{ project.budget | currency }}</span>
          </div>
        </div>

        <div class="progress-section" *ngIf="project.taskCount && project.taskCount > 0">
          <div class="progress-label">
            <span>Tasks Progress</span>
            <span>{{ project.completedTaskCount || 0 }}/{{ project.taskCount }} ({{ getProgressPercentage(project) }}%)</span>
          </div>
          <mat-progress-bar 
            mode="determinate" 
            [value]="getProgressPercentage(project)"
            [color]="getProgressPercentage(project) === 100 ? 'primary' : 'accent'">
          </mat-progress-bar>
        </div>

        <div class="dates">
          <div class="date-item">
            <mat-icon>event</mat-icon>
            <span>{{ project.startDate | date:'MMM dd, yyyy' }} - {{ project.endDate | date:'MMM dd, yyyy' }}</span>
          </div>
        </div>

        <div class="members" *ngIf="project.members && project.members.length > 0">
          <mat-icon>group</mat-icon>
          <span>{{ project.members.length }} member{{ project.members.length !== 1 ? 's' : '' }}</span>
        </div>
      </mat-card-content>

      <mat-card-actions>
        <button mat-button [routerLink]="['/projects', project.id]">
          <mat-icon>visibility</mat-icon>
          View
        </button>
        <button mat-button (click)="editProject(project)">
          <mat-icon>edit</mat-icon>
          Edit
        </button>
        <button mat-button color="warn" (click)="deleteProject(project)">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <div class="loading-container" *ngIf="loading">
    <mat-icon class="loading-spinner">refresh</mat-icon>
    <p>Loading projects...</p>
  </div>

  <div class="empty-state" *ngIf="!loading && filteredProjects.length === 0 && searchTerm">
    <mat-icon>search_off</mat-icon>
    <h3>No Projects Found</h3>
    <p>No projects match your search criteria "{{ searchTerm }}".</p>
    <button mat-button (click)="clearSearch()">
      <mat-icon>clear</mat-icon>
      Clear Search
    </button>
  </div>

  <div class="empty-state" *ngIf="!loading && projects.length === 0">
    <mat-icon>folder_open</mat-icon>
    <h3>No Projects Found</h3>
    <p>Create your first project to get started.</p>
    <button mat-raised-button color="primary" (click)="createProject()">
      <mat-icon>add</mat-icon>
      Create Project
    </button>
  </div>
</div>
